# -*- coding: utf-8 -*-
"""eval

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1pTlFA8zrNOQSxcGT3MXWCARzhUZ7EeDV
"""

model.eval()
for X, masks in val_dl:
    X = X.cuda()
    output = model(X)
    break

num_item = 1
image, mask, predicted = X[num_item],  masks[num_item], output[num_item, 1]
plt.figure(figsize=(12,4))
plt.subplot(131)
plt.imshow(image.permute(1,2,0).cpu())
plt.subplot(132)
plt.imshow(mask[1].cpu(), cmap='gray')
#(mask[1] if mask.ndim == 3 else mask, cmap='gray')
plt.subplot(133)
plt.imshow(predicted.detach().cpu(), cmap='gray')
plt.show()